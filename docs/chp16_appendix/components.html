<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Fundamentals: Component-Based Design - High Assurance Rust: Developing Secure and Robust Software</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">High Assurance Rust: Developing Secure and Robust Software</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/tnballo/high-assurance-rust" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://highassurance.rs/engage.html#submit-feedback-questions-issues-or-prs" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <meta name="title" content="High Assurance Rust">
<meta name="description" content="Developing Secure and Robust Software">
<meta property="og:title" content="High Assurance Rust">
<meta property="og:description" content="Developing Secure and Robust Software">
<meta property="og:type" content="article">
<meta property="og:url" content="https://highassurance.rs/">
<meta property="og:image" content="https://highassurance.rs/img/har_logo_social.png">
<meta name="twitter:title" content="High Assurance Rust">
<meta name="twitter:description" content="Developing Secure and Robust Software">
<meta name="twitter:url" content="https://highassurance.rs/">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://highassurance.rs/img/har_logo_social.png">
<h1 id="fundamentals-component-based-design"><a class="header" href="#fundamentals-component-based-design">Fundamentals: Component-Based Design</a></h1>
<p>Assume an Application Programming Interface (API) includes one or more of the below pieces:</p>
<ul>
<li>Data type definitions (structures, enums, etc)</li>
<li>Function declarations</li>
<li>Constants</li>
<li>Specifications for remote request-response formats, such as:
<ul>
<li>REST (Representational State Transfer)<sup class="footnote-reference" id="fr-REST-1"><a href="#footnote-REST">1</a></sup></li>
<li>gRPC (Google Remote Procedure Call)<sup class="footnote-reference" id="fr-GRPC-1"><a href="#footnote-GRPC">2</a></sup></li>
</ul>
</li>
</ul>
<p>"Deep modules", according to John Ousterhout<sup class="footnote-reference" id="fr-DeepMod-1"><a href="#footnote-DeepMod">3</a></sup>, are those in which well-designed APIs hide, or abstract, an iceberg of underlying complexity.</p>
<p>Deep modules often have the advantage of making codebases easier to maintain and refactor.
Good abstractions also make APIs straightforward to learn initially and use correctly.
Whether the interface is for an external customer or for another component within the codebase.</p>
<p>Depth becomes especially important once we consider the cumulative complexity of a large system with multiple <em>components</em>.</p>
<p>In most contexts, <em>module</em> and <em>component</em> are synonymous.
But for our purposes, a component is composed of one or more modules.
So a component is a bigger (potentially multi-module) piece.
We'll soon see diagrams that make this distinction clearer.</p>
<blockquote>
<p><strong>What's a real-world example of a "deep module"?</strong></p>
<p>Ousterhout cites <em>system calls</em><sup class="footnote-reference" id="fr-DeepMod-2"><a href="#footnote-DeepMod">3</a></sup>, the OS mechanism by which userspace applications request hardware-related and/or privileged services, as a prototypical example.</p>
<p>A small handful of calls abstract the gory details of, say, writing a file to a physical hard disk of a particular variety and manufactured by a particular vendor.
The OS provides a small and stable API <em>externally</em>, while being free to manage the inherent complexity <em>internally</em>.</p>
<p>One could argue that the core project of this book is, like many other dynamic collections, also a deep module.
We provide an API-compatible alternative to a standard library collection, but abstract away the specifics of the underlying data structure and its memory management strategy.</p>
</blockquote>
<p>So, when leveraging any code organization facility, be it Rust's module system or some other language's equivalent, our goal is to create "deep" modules and collect them into components with "loose" coupling.
Meaning well-isolated pieces that offer rich functionality via a small API surface.</p>
<p>In general, this approach results in a codebase that's easier to work with for new team members and easier to improve for everyone.
That means less time firefighting and more time shipping new features.
And, by keeping complexity in check, we also reduce security and reliability risks.</p>
<h2 id="effective-componentization"><a class="header" href="#effective-componentization">Effective Componentization</a></h2>
<p>Depth tends to, naturally, minimize coupling and maximize cohesion. Defined as<sup class="footnote-reference" id="fr-Ccord-1"><a href="#footnote-Ccord">4</a></sup>:</p>
<ul>
<li>
<p><strong>Coupling:</strong> a measure of interdependency between APIs.</p>
<ul>
<li>E.g. Mutual reliance on the same custom data types in public signatures. Or private, global shared state.</li>
</ul>
</li>
<li>
<p><strong>Cohesion:</strong> a measure of the commonality between individual elements of an API.</p>
<ul>
<li>E.g. Do functions exposed by a module have a clear logical relationship to each other? If so, the module has high cohesion.</li>
</ul>
</li>
</ul>
<p>While low coupling, high cohesion components are generally desirable, they may not always be practical.
For example, a centralized piece of functionality can be more easily replaced with a faster algorithm or a more secure implementation.
But centralization sometimes increases coupling.</p>
<p>Similarly, an API that's overly-specific is hard to future-proof - new requirements can mean a breaking change.
But if an API is too general, it likely requires cumbersome wrappers to meet current, specific needs without reducing cohesion.</p>
<h2 id="visualizing-component-based-design"><a class="header" href="#visualizing-component-based-design">Visualizing Component-based Design</a></h2>
<p>Components whose modules have fewer and simpler public APIs often entail less stability burden and lower chance of misuse.
Such components help us more effectively compose large, ambitious, multi-component systems.</p>
<p>Visually, that entails moving away from <strong>fragile systems</strong> where components expose and rely on each other's internals:</p>
</br>
<p align="center">
  <img width="100%" src="mod_shallow.svg">
  <figure>
  <figcaption><center>Fragile: shallow components with high/complex coupling.</center></figcaption><br>
  </figure>
</p>
<p>And toward <strong>agile systems</strong> that abstract away internal complexity (while delivering the same functionality):</p>
</br>
<p align="center">
  <img width="100%" src="mod_deep.svg">
  <figure>
  <figcaption><center>Agile: deep components with low/loose coupling.</center></figcaption><br>
  </figure>
</p>
<p>Here, "agile" means a codebase that's easy to onboard for, extend, and refactor.
Not Agile<sup class="footnote-reference" id="fr-Agile-1"><a href="#footnote-Agile">5</a></sup>, the umbrella term for a set of software development frameworks.</p>
<p>Note how, in both designs, the number of modules within each component (six) didn't change.
We're not removing functionality, just external-facing complexity.
The end user's cognitive load is reduced.
Total "work done" isn't.</p>
<h2 id="the-importance-of-planning-and-iterating"><a class="header" href="#the-importance-of-planning-and-iterating">The Importance of Planning and Iterating</a></h2>
<p>Complexity is the enemy of both productivity and security.
But the first iteration of a feature to hit production likely won't be elegantly crafted.
Aiming for perfection is unrealistic in most commercial contexts.</p>
<p>Instead, we can aim to make our first version <em>well-designed</em>.
That may mean using our organization's or team's current quality bar as a watermark.
And striving to push it a bit higher while still delivering on time.</p>
<p>Now the first architecture is sometimes the one a system gets stuck with for its entire lifecycle.
So budgeting design time up front can pay significant dividends.
For production infrastructure, the result could be a reduced number of 3:00am phone calls for outages and breaches.
But the average case, planned maintenance, is also lower cost for well-designed systems.</p>
<p>The best designs for high-value systems are almost always a result of iteration.
When we have the opportunity to significantly refactor an existing system, or create a successor from scratch, we can apply lessons learned.
So even if you can't justify a sweeping change today, it's worth noting current limitations for tomorrow.</p>
<h2 id="takeaway"><a class="header" href="#takeaway">Takeaway</a></h2>
<p>Low-complexity systems tend to be more reliable, maintainable, and secure.
Keeping complexity in check typically means designing for low coupling and high cohesion.
Deep modules lend themselves well to both goals.</p>
<hr>
<ol class="footnote-definition"><li id="footnote-REST">
<p><a href="https://www.redhat.com/en/topics/api/what-is-a-rest-api">What is a REST API?</a>. RedHat (2020). <a href="#fr-REST-1">↩</a></p>
</li>
<li id="footnote-GRPC">
<p><a href="https://grpc.io/docs/what-is-grpc/core-concepts/">Core concepts, architecture and lifecycle</a>. Google (Accessed 2022). <a href="#fr-GRPC-1">↩</a></p>
</li>
<li id="footnote-DeepMod">
<p><a href="https://amzn.to/3DbaPrp"><em><strong>[PERSONAL FAVORITE]</strong> A Philosophy of Software Design</em></a>. John Ousterhout (2021). <a href="#fr-DeepMod-1">↩</a> <a href="#fr-DeepMod-2">↩2</a></p>
</li>
<li id="footnote-Ccord">
<p><a href="https://amzn.to/3wBuNu7"><em><strong>[PERSONAL FAVORITE]</strong> Effective C: An Introduction to Professional C Programming</em></a>. Robert Seacord (2020). <a href="#fr-Ccord-1">↩</a></p>
</li>
<li id="footnote-Agile">
<p><a href="https://www.agilealliance.org/agile101/"><em>What is Agile?</em></a>. Agile Alliance (Accessed 2022). <a href="#fr-Agile-1">↩</a></p>
</li>
</ol>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../chp16_appendix/types.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../chp16_appendix/mem_hierarch.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../chp16_appendix/types.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../chp16_appendix/mem_hierarch.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
